<%= title "Listing mappings for #{@survey.name}", true %>

<%= render :partial => 'edit_links' %>

<ol class="object_mappings">
<% @survey.object_mappings.each do |object_mapping|%>
	<li class="object_mapping">
		<div class="object_name">
			<h3>
				Insert into <%= object_mapping.salesforce_object_name %> :
				<i>Changed <%= distance_of_time_in_words(Time.now, object_mapping.updated_at) %> ago</i>
			</h3>
			<div class="actions"><%= link_to 'Delete', object_mapping_path(object_mapping), :confirm => 'Are you sure you want to delete this one?', :method => :delete %></div>
			<div class="clear"></div>
		</div>
		<div>
			<ol class="field_mappings">
			<% object_mapping.field_mappings.each do |field_mapping| %>
				<li>
					<div class="field_mapping">
						<div class="mapping">
							<%= field_mapping.field_name %> - 
								<% if field_mapping.lookup? %>
									<%= field_mapping.lookup_object_name %> WHERE <%=field_mapping.lookup_condition %> 
								<% elsif field_mapping.predefined_value? %>
									<%= field_mapping.predefined_value %>
								<% elsif field_mapping.question? %>
									<%= field_mapping.question_name %>
								<% end %>
								:
								<i>Changed <%= distance_of_time_in_words(Time.now, field_mapping.updated_at) %> ago</i>
						</div>
						<div class="actions">
							<%= link_to 'Delete', field_mapping_path(field_mapping), 
							:confirm => "Are you sure you want to delete the mapping between #{field_mapping.field_name} and #{field_mapping.question_name}", :method => :delete%>
						</div>
						<div class="clear"></div>
					</div>
				</li>
			<%end%>
			</ol>
		</div>
	</li>
<%end%>
</ol>

<%= render :partial => 'edit_links' %>